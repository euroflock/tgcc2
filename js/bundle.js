!function(t){function e(o){if(i[o])return i[o].exports;var n=i[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(1),i(3),i(5),i(2),i(4),i(6),i(7),i(9),t.exports=i(8)},function(t,e,i){var o=i(2).ClientApp;!function(){window.clientApp=new o,clientApp.run()}()},function(t,e,i){var o=i(3),n=i(4).EventDriven,a=i(5).Chart,r=i(9).MainView,s=function(){this.device=null,this.mainView=null,this.chartsData=null,this.charts=null};o.extend(s,n),s.prototype.run=function(){o.getElement("body").innerHTML="",o.getElement("title").innerText="TELEGRAM CONTEST CHARTS",o.on("body","contextmenu",function(t){o.no(t,!0)});try{document.createEvent("TouchEvent"),this.device="touch"}catch(t){this.device="mouse"}this.fetchRemoteData(function(t){var e=this;this.chartsData=t;var i=localStorage.getItem("theme");i=["light","dark"].indexOf(i)!==-1?i:"dark",this.mainView=new r({app:this,className:"main-view "+i,appendTo:o.getElement("body")}),o.on(this.mainView.switchThemeToDay,"click",function(t){o.no(t,!0),o.toggleClass(e.mainView.switchThemeToDay,"active",!1),o.toggleClass(e.mainView.switchThemeToNight,"active",!0),o.toggleClass(e.mainView.$container,"dark",!1),localStorage.setItem("theme","light"),e.charts.map(function(t){t.model.renderStyle="light",t.refreshModel()})}),o.on(this.mainView.switchThemeToNight,"click",function(t){o.no(t,!0),o.toggleClass(e.mainView.switchThemeToNight,"active",!1),o.toggleClass(e.mainView.switchThemeToDay,"active",!0),o.toggleClass(e.mainView.$container,"dark",!0),localStorage.setItem("theme","dark"),e.charts.map(function(t){t.model.renderStyle="dark",t.refreshModel()})});for(var n=1;n<=this.chartsData.length;n++){var s="chart"+n;this[s]=new a({id:s,title:"Chart "+n,app:this,defaultTheme:i,chartData:this.chartsData[n-1],appendTo:this.mainView.chartsContainer}),this.charts||(this.charts=[]),this.charts.push(this[s])}switch(i){case"light":o.toggleClass(e.mainView.switchThemeToNight,"active",!0);break;default:o.toggleClass(e.mainView.switchThemeToDay,"active",!0)}window.onresize=function(){this.onViewResize()}.bind(this)}.bind(this))},s.prototype.onViewResize=function(){this.trigger("resize")},s.prototype.fetchRemoteData=function(t){o.remoteRequest("/tgcc2/chart_data.json",function(e){var i,o,n,a,r,s,h,l,d,m;try{n=JSON.parse(e),r=[];for(i in n){if(a=n[i],s={lines:{},names:a.names,actives:[],keys:Object.keys(a.names),colors:a.colors},a.names){h=Object.keys(a.columns);for(o in h)l=h[o],d=a.columns[l],m=d[0],d.shift(),d.push(null),s.lines[m]=d,s.actives[m]=!0}r.push(s)}}catch(t){r=null}t(r)})},e.ClientApp=s},function(t,e){var i=CanvasRenderingContext2D.prototype.moveTo,o=CanvasRenderingContext2D.prototype.lineTo,n=CanvasRenderingContext2D.prototype.quadraticCurveTo,a=CanvasRenderingContext2D.prototype.fillRect,r=CanvasRenderingContext2D.prototype.strokeRect,s=CanvasRenderingContext2D.prototype.rect,h=CanvasRenderingContext2D.prototype.clearRect;CanvasRenderingContext2D.prototype.moveTo=function(t,e){t=t>0?~~t:t,e=e>0?~~e:e,this.lineWidth%2!==0&&(t+=.5,e+=.5),i.apply(this,arguments)},CanvasRenderingContext2D.prototype.lineTo=function(t,e){t=t>0?~~t:t,e=e>0?~~e:e,this.lineWidth%2!==0&&(t+=.5,e+=.5),o.apply(this,arguments)},CanvasRenderingContext2D.prototype.quadraticCurveTo=function(t,e,i,o){t=t>0?~~t:t,e=e>0?~~e:e,i=i>0?~~i:i,o=o>0?~~o:o,this.lineWidth%2!==0&&(t+=.5,e+=.5,i+=.5,o+=.5),n.apply(this,arguments)},CanvasRenderingContext2D.prototype.fillRect=function(t,e,i,o){t=~~t,e=~~e,i=~~i,o=~~o,a.apply(this,arguments)},CanvasRenderingContext2D.prototype.strokeRect=function(t,e,i,o){t=~~t,e=~~e,i=~~i,o=~~o,r.apply(this,arguments)},CanvasRenderingContext2D.prototype.rect=function(t,e,i,o){t=~~t,e=~~e,i=~~i,o=~~o,s.apply(this,arguments)},CanvasRenderingContext2D.prototype.roundRect=function(t,e,i,o,n,a,r){var s={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0};"undefined"==typeof r&&(r=!0);var h;if("object"==typeof n)for(h in n)s[h]=n[h];if("number"==typeof n)for(h in s)s[h]=n;this.beginPath(),this.moveTo(t+s.upperLeft,e),this.lineTo(t+i-s.upperRight,e),this.quadraticCurveTo(t+i,e,t+i,e+s.upperRight),this.lineTo(t+i,e+o-s.lowerRight),this.quadraticCurveTo(t+i,e+o,t+i-s.lowerRight,e+o),this.lineTo(t+s.lowerLeft,e+o),this.quadraticCurveTo(t,e+o,t,e+o-s.lowerLeft),this.lineTo(t,e+s.upperLeft),this.quadraticCurveTo(t,e,t+s.upperLeft,e),this.closePath(),r&&this.stroke(),a&&this.fill()},CanvasRenderingContext2D.prototype.clearRect=function(t,e,i,o){t=~~t,e=~~e,i=~~i,o=~~o,h.apply(this,arguments)},CanvasRenderingContext2D.prototype.dashedLinePattern=function(t,e,i,o,n,a,r,s){this.save(),this.beginPath(),this.strokeStyle=a||this.strokeStyle||"red",this.lineWidth=r||1,this.lineCap=s||"butt";var h=Math.sqrt(Math.pow(i-t,2)+Math.pow(o-e,2)),l={x:(i-t)/h,y:(o-e)/h},d=0,m=0;for(n=n&&n.length?n:[4,4];d<h;){var c=Math.min(n[m++%n.length],h-d),p=m%2;d+=c,p&&this.moveTo(t+.5,e+.5),t+=c*l.x,e+=c*l.y,p&&this.lineTo(t+.5,e+.5)}this.stroke(),this.restore()},window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){var i=(new Date).getTime(),o=Math.max(0,16-(i-("undefined"!=typeof lastTime?lastTime:0))),n=window.setTimeout(function(){t(i+o)},o);return lastTime=i+o,n}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var i=0;i<this.length;i++)t.call(e,this[i],i,this)}),Math.log2=Math.log2||function(t){return Math.log(t)/Math.log(2)},e.inherit=function(t,e){if(!t)throw"Inherit - child undefined!";if(!e)throw"Inherit - parent undefined!";var i,o,n=t.prototype;t.prototype=Object.create(e.prototype);var a=Object.getOwnPropertyNames(n);for(i=a.length;i--;)n.hasOwnProperty(a[i])&&(o=Object.getOwnPropertyDescriptor(n,a[i]),Object.defineProperty(t.prototype,a[i],o));t.prototype.constructor=t,t.superclass=e.prototype},e.extend=function t(e,i,o){if(!e)throw"Extend - class undefined!";if(!i)throw"Extend - trait undefined!";var n=i,a=o?e:e.prototype;i.prototype&&t(e,i.prototype,o);for(var r in n){var s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(a,r,s)}},e.no=function(t,e){"undefined"!=typeof t.preventDefault&&t.preventDefault(),"undefined"!=typeof t.returnValue&&(t.returnValue=!1),e===!0&&("undefined"!=typeof t.stopPropagation&&t.stopPropagation(),"undefined"!=typeof t.cancelBubble&&(t.cancelBubble=!0))},e.calculateWidth=function(t,e){this.canvas||(this.canvas=d({tag:"canvas",class_name:"technical",attributes:[{width:"100"},{height:"100"}]}),this.ctx=this.canvas.getContext("2d"),this.fontFamily="Tahoma",this.fontSize=12,this.paddingLeft=5,this.paddingRight=5,this.ctx.font=this.fontSize+"px "+this.fontFamily),t=t||"",e=e||{};var i=!1;e.fontFamily&&"string"==typeof e.fontFamily&&(this.fontFamily=e.fontFamily,i=!0),e.fontSize&&"number"==typeof e.fontSize&&(this.fontSize=e.fontSize,i=!0),i&&(this.ctx.font=this.fontSize+"px "+this.fontFamily),null!=e.paddingLeft&&"number"==typeof e.paddingLeft&&(this.paddingLeft=e.paddingLeft),null!=e.paddingRight&&"number"==typeof e.paddingRight&&(this.paddingRight=e.paddingRight);var o=this.ctx.measureText(t);return this.paddingLeft+o.width+this.paddingRight};var l=function(t){return"undefined"!=typeof t&&t?"string"==typeof t?document.querySelector(t):t instanceof HTMLElement?t:null:null};e.getElement=l;var d=function(t){if("object"!=typeof t)return null;var i,o,n,a,r,s,h,d,m;if(i="string"!=typeof t.tag?"DIV":t.tag.toUpperCase(),"br"==i.toLowerCase())return null;o=t.id||null,"?"==o&&(o=i+e.uid()),"undefined"==typeof t.target||null==t.target||(n="string"==typeof n?l(n):t.target),a="undefined"!=typeof t.display?t.display===!0:null,r=t.class_name||null,s=t.style||null,h=t.attributes||null,m=t.before||null,d=t.html||null;var c=document.createElement(i);return null!==o&&(c.id=o),null!==r&&(c.className=r),null!==d&&(c.innerHTML=d),null!==s&&c.setAttribute("style",s),a===!1&&(c.style.display="none"),null!==h&&h.length>0&&h.forEach(function(t){c.setAttribute(Object.keys(t)[0],t[Object.keys(t)[0]])}),"undefined"!=typeof m?("number"==typeof m?m=n.children[m]:"string"==typeof m&&(m=l(m)),n&&n.insertBefore(c,m)):n&&n.appendChild(c),c};e.createElement=d,e.hasClass=function(t,e){return"undefined"!=typeof e&&(t=l(t),!!t&&t.className.indexOf(e)!==-1)},e.addClass=function(t,e){return"undefined"!=typeof e&&(!!(t=l(t))&&(t.className.indexOf(e)===-1&&(t.className=(t.className+" "+e).trim(),t)))},e.removeClass=function(t,e){if(t=l(t),!t)return!1;if("undefined"!=typeof e){var i=t.className;return t.className=i.replace(e,"").trim(),t}},e.toggleClass=function(t,i,o){return t=l(t),!!t&&("undefined"!=typeof i?"undefined"!=typeof o?o===!0?e.addClass(t,i):e.removeClass(t,i):e.hasClass(t,i)?e.removeClass(t,i):e.addClass(t,i):void 0)};var m=function(t){for(var e=0,i=0;t;)i+=parseInt(t.offsetTop,10),e+=parseInt(t.offsetLeft,10),t=el_.offsetParent;return{left:e,top:i}},c=function(t){var e=t.getBoundingClientRect(),i=document.body,o=document.documentElement,n=window.pageYOffset||o.scrollTop||i.scrollTop,a=window.pageXOffset||o.scrollLeft||i.scrollLeft,r=o.clientTop||i.clientTop||0,s=o.clientLeft||i.clientLeft||0,h=e.top+n-r,l=e.left+a-s;return{left:Math.round(l),top:Math.round(h)}},p=function(t){return t=l(t),!!t&&(t.getBoundingClientRect?c(t):m(t))};e.box=function(t,e,i){if(t=l(t),!t)return!1;if("undefined"==typeof e||"object"!=typeof e){var o=p(t),n=o.left,a=o.top,r=t.offsetWidth,s=t.offsetHeight;return{l:n,t:a,w:r,h:s,left:n,top:a,width:r,height:s}}return i!==!0&&(t.style.position="absolute"),"undefined"!=typeof e.l?t.style.left=""+e.l+"px":"undefined"!=typeof e.left&&(t.style.left=""+e.left+"px"),"undefined"!=typeof e.t?t.style.top=""+e.t+"px":"undefined"!=typeof e.top&&(t.style.top=""+e.top+"px"),"undefined"!=typeof e.w?t.style.width=""+e.w+"px":"undefined"!=typeof e.width&&(t.style.width=""+e.width+"px"),"undefined"!=typeof e.h?t.style.height=""+e.h+"px":"undefined"!=typeof e.height&&(t.style.height=""+e.height+"px"),t},e.isPointInBox=function(t,i,o){var n=t.x||t.pageX,a=t.y||t.pageY,r=!1;return n>=i.l&&n<=i.l+i.w&&a>=i.t&&a<=i.t+i.h&&(r=!0),r&&"undefined"!=typeof o&&(r=e.isPointInBox(t,o)),r};var f,u;document.addEventListener?(f=function(t,e,i,o){return!!(t=l(t))&&(t.addEventListener(e,i,!!o),i)},u=function(t,e,i,o){return!!(t=l(t))&&(t.removeEventListener(e,i,!!o),!0)}):document.attachEvent?(f=function(t,e,i){if(t=l(t),!t)return!1;e="on"+e;var o=function(){return i.apply(t,arguments)};return t.attachEvent(e,o),o},u=function(t,e,i){return!!(t=l(t))&&(e="on"+e,t.detachEvent(e,i),!0)}):(f=function(t,e,i){if(t=l(t),!t)return!1;e="on"+e,t.store=t.store||{},t.store[e]||(t.store[e]={counter:1},t[e]=function(){for(var t in o)o.hasOwnProperty(t)&&"function"==typeof o[t]&&o[t].apply(this,arguments)});var o=t.store[e],n=o.counter++;return o[n]=i,n},u=function(t,e,i){return!!(t=l(t))&&(e="on"+e,t.store&&t.store[e]&&t.store[e][i]&&(t.store[e][i]=void 0),!0)}),e.on=f,e.off=u,e.remoteRequest=function(t,e,i,o){var n=function(t,e){var i,o="",n=encodeURIComponent;for(i in t)o+="&"+n(i)+"="+n(t[i]);return o.slice(1)+(e?"":"&_t="+Date.now())};i&&"object"==typeof i&&(i=n(i,o));try{var a=new XMLHttpRequest("MSXML2.XMLHTTP.3.0");a.open(i?"POST":"GET",t,1),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Content-type",(i?"application/x-www-form-urlencoded":"application/json")+"; charset=UTF-8"),a.onreadystatechange=function(){a.readyState>3&&e&&e(a.responseText,a)},a.send(i)}catch(t){console.error(t.message)}},e.formatTo3=function(t,e){e=e||" ";for(var i=""+t,o="",n=i.length-1;n>=0;n-=3)o=(i[n-2]||"")+(i[n-1]||"")+(i[n]||"")+(n==i.length-1?"":e)+o;return o},e.toFixed=function(t,e){return e=e||0,Number(t).toFixed(e)},e.collapseNumber=function(t){return"number"==typeof t&&(t=e.toFixed(t,0)),void 0===t&&(t=""),e.formatNumber(t,{digitsAfterDot:0}).replace(/0{6}$/,"M").replace(/0{3}$/,"K")},e.separateThousandsInInteger=function(t,e){null==e&&(e=" ");for(var i=parseInt(t).toString();/(\d+)(\d{3})/.test(i);)i=i.toString().replace(/(\d+)(\d{3})/,"$1"+e+"$2");return i},e.formatNumber=function(t,i){if(null==t)return"—";if("string"==typeof t&&""===t.trim())return 0;"string"==typeof t&&(t=Number(t)),i=i||{},i.thousandsSeparator=i.thousandsSeparator||" ",i.digitsAfterDot=void 0!==i.digitsAfterDot?i.digitsAfterDot:2;var o=Number(String(t).replace(/\s/g,""));i.digitsAfterDot&&i.digitsAfterDot>fixedDigits&&(i.digitsAfterDot=fixedDigits);var n=o/Math.abs(o);o=Math.abs(o),o=Math.round(o,i.digitsAfterDot);var a=e.separateThousandsInInteger(Math.floor(o),i.thousandsSeparator),r=e.toFixed(o,i.digitsAfterDot).split(".")[1]||"";return r&&(r="."+r),n<0&&(a="-"+a),a+r};var g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],v=["January","February","March","April","May","June","July","August","September","Octpber","November","December"];e.formatDate=function(t,e){var i=new Date(e);switch(t){case"Week, d Month YEAR":return g[i.getDay()]+", "+i.getDate()+" "+v[i.getMonth()]+" "+i.getFullYear();case"Wee, d Mon YEAR":return g[i.getDay()].slice(0,3)+", "+i.getDate()+" "+v[i.getMonth()].slice(0,3)+" "+i.getFullYear();case"d Month YEAR":return i.getDate()+" "+v[i.getMonth()]+" "+i.getFullYear();case"d Month":return i.getDate()+" "+v[i.getMonth()];case"d Mon":return i.getDate()+" "+v[i.getMonth()].slice(0,3)}},e.getCrossLinePoint=function(t,e){var i=t.x1,o=t.y1,n=t.x2,a=t.y2,r=e.x1,s=e.y1,h=e.x2,l=e.y2,d=n-i,m=a-o,c=h-r,p=l-s,f=(-m*(i-r)+d*(o-s))/(-c*m+d*p),u=(+c*(o-s)-p*(i-r))/(-c*m+d*p),g=f>=0&&f<=1&&u>=0&&u<=1;return g?{x:i+u*(n-i),y:o+u*(a-o)}:null}},function(t,e){var i,o,n,a,r,s,h,l=function(){this._events={}};l.prototype.on=function(t,e,i,o){var n;"function"==typeof e&&(o=i,i=e,e=void 0);var a=this._events||(this._events={}),r=a[t]||(a[t]=[]);return r.push([n||i,o,e]),this},l.prototype.off=function(t,e){var i=this._events||(this._events={}),o=i[t]||(i[t]=[]);return i[t]=o.filter(function(t){return void 0!==e&&t[1]!==e}),this},l.prototype.destroy=function(){this._events={}},l.prototype.execute=function(t){for(i=this._events||(this._events={}),o=i[t]||(i[t]=[]),n=Array.prototype.splice.call(arguments,1),s=o.length,r=0;r<s;r++)h=o[r][1]||this,a="undefined"!=typeof o[r][2]?n.concat([o[r][2]]):n,o[r][0].apply(h,a)},l.prototype.trigger=function(t,e){this.execute.apply(this,arguments)},e.EventDriven=l},function(t,e,i){var o=i(3),n=i(4).EventDriven,a=i(6).Interaction,r=i(7).ChartView,s=function(t){this.id=t.id,this.app=t.app,this.title=t.title,this.data=t.chartData||[],this.container=t.appendTo,this.isModelRefreshed=!1,this.animationDuration=400,this.currentAnimationCancel=null,this.prevState=null,this.interactionExtends=5,this.preventTopTimeout=null,this.preventbottomTimeout=null,this.defaultTheme=["light","dark"].indexOf(t.defaultTheme)!==-1?t.defaultTheme:"dark";var e=new Image;e.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'%3E%3Cpolyline points='18,33.5 25.5,41 42,24' stroke='white' stroke-width='6' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E";var i=new Image;i.src='data:image/svg+xml,<svg aria-hidden="true" focusable="false" data-icon="angle-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path style="fill: lightgray;" d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path></svg>',this.model={id:this.id,checkerImg:e,arrowImg:i,data:this.data,title:this.title,renderStyle:this.defaultTheme,topChanged:!0,bottomChanged:!0,style:{light:{bgColor:"#ffffff",title:"#222222",tooltipBg:"#ffffff",tooltipShadow:"#e1e4e6",tooltipTitle:"#222222",axisColor:"#e7e9eb",gridColor:"#e7e9eb",timeColor:"#8e8e93",gridValuesColor:"#8e8e93",crosshairColor:"#dfe6eb",bottomColor:"rgba(237,245,251,0.65)",caretColor:"#c0d1e1",caretHoleColor:"#fff",labelBorder:"#e6ecf0",labelText:"#fff"},dark:{bgColor:"#242f3e",title:"#ffffff",tooltipBg:"#1c2533",tooltipShadow:"transparent",tooltipTitle:"#ffffff",axisColor:"#3a4451",gridColor:"#3a4451",timeColor:"#87909a",gridValuesColor:"#87909a",crosshairColor:"#3b4a5a",bottomColor:"rgba(43,58,77,0.65)",caretColor:"#56626d",caretHoleColor:"#fff",labelBorder:"#344658",labelText:"#fff"}},axisXValues_opacity:1,renderMode:1,draggingMode:!1,startIndex:null,shiftX:0,count:20,gridSpace:24,countShift:1,minCount:20,space:20,lineWidth:3,scale:1,paddingTop:100,paddingBottom:185,paddingLeft:0,paddingRight:0,digits:0,interactionDownX:null,interactionDownY:null,interactionDownStartIndex:null,interactionMoveX:null,interactionMoveY:null,interactionActivated:!1,bottomChart:{top:0,left:0,height:54,width:0,lineWidth:1,paddingLeft:24,paddingRight:24,caret:{left:{x:0,y:0,w:0,h:0},right:{x:0,y:0,w:0,h:0},frame:{x:0,y:0,w:0,h:0,left:{x:0,y:0,w:0,h:0},right:{x:0,y:0,w:0,h:0}}}},labels:[],point:null,crosshair:null,animatePoint:null,theme:{}},this.view=new r({app:this.app,className:"chart "+this.id,extraClassName:this.model.renderStyle,appendTo:this.container}),this.interaction=new a({app:this.app,view:this.view}),this.bindEvents()};o.extend(s,n),s.prototype.bindEvents=function(){this.app.on("resize",this.onViewResize,this),this.view.on("ready",this.onViewReady,this)},s.prototype.onViewReady=function(){this.model.startIndex=this.model.data.lines.x.length-this.model.count,this.interactionActivated||(this.model.interactionActivated=!0,this.bindInteractionEvents(),this.interaction.activate()),this.onViewResize()},s.prototype.onViewResize=function(){this.data&&(this.view.resize(),this.refreshModel(),this.correctPosition(),this.refreshModel(!0))},s.prototype.bindInteractionEvents=function(){this.interaction.on("down",this.onInteractionDown,this),this.interaction.on("move",this.onInteractionMove,this),this.interaction.on("up",this.onInteractionUp,this)},s.prototype.unBindInteractionEvents=function(){this.interaction.off("down",this),this.interaction.off("move",this),this.interaction.off("up",this)},s.prototype.getXFromEvent=function(t){return t.targetTouches?t.targetTouches.length?t.targetTouches[0].pageX-this.view.left:t.changedTouches.length?t.changedTouches[0].pageX-this.view.left:void 0:(t.pageX||0)-this.view.left},s.prototype.getYFromEvent=function(t){return t.targetTouches?t.targetTouches.length?t.targetTouches[0].pageY-this.view.top:t.changedTouches.length?t.changedTouches[0].pageY-this.view.top:void 0:(t.pageY||0)-this.view.top},s.prototype.onInteractionDown=function(t){this.interactionPart=null;var e=this.getXFromEvent(t),i=this.getYFromEvent(t),n={l:this.model.left,t:this.model.top,w:this.model.width,h:this.model.height};if(o.isPointInBox({x:e,y:i},n)){if(this.model.point){var a={l:this.model.point.x,t:this.model.point.y,w:this.model.point.w,h:this.model.point.h};if(o.isPointInBox({x:e,y:i},a)&&this.model.point.canZoom)return void(this.interactionPart="point");if(Math.abs(this.model.point.xx-e)>=this.model.space/2){var r=this.view.getNearestPointByX(e,this.model),s=r.x;return this.model.point.way=s>this.model.point.xx,this.model.point.dist=0,this.model.animatePoint={from:{x:this.model.point.xx},to:{x:s}},void this.animateTransition({animatePointFrom:this.model.animatePoint.from},{animatePointTo:this.model.animatePoint.to})}}this.model.animatePoint=null,this.interactionPart="topChart",this.model.interactionDownX=this.getXFromEvent(t)-this.model.shiftX,this.model.interactionDownY=this.getYFromEvent(t);var h=this.model.data.lines.x.length-this.model.count;return this.model.interactionDownStartIndex=this.model.startIndex||h,null==this.model.startIndex?this.model.interactionDownStartIndex=h:this.model.interactionDownStartIndex=this.model.startIndex,this.model.pointX=this.getXFromEvent(t)-this.model.shiftX,void(this.model.pointY=this.getYFromEvent(t))}var l={l:this.model.bottomChart.caret.frame.left.x-this.interactionExtends,t:this.model.bottomChart.caret.frame.left.y-this.interactionExtends,w:this.model.bottomChart.caret.frame.left.w+2*this.interactionExtends,h:this.model.bottomChart.caret.frame.left.h+2*this.interactionExtends};if(o.isPointInBox({x:e,y:i},l))return this.interactionPart="caretFrameLeft",this.model.interactionDownX=this.getXFromEvent(t)+this.model.shiftX*this.model.bottomChart.space/this.model.space,this.model.interactionDownY=this.getYFromEvent(t),this.model.interactionDownStartIndex=this.model.startIndex,this.model.interactionDownStartCount=this.model.count,this.model.pointX=null,void(this.model.pointY=null);var d={l:this.model.bottomChart.caret.frame.right.x-this.interactionExtends,t:this.model.bottomChart.caret.frame.right.y-this.interactionExtends,w:this.model.bottomChart.caret.frame.right.w+2*this.interactionExtends,h:this.model.bottomChart.caret.frame.right.h+2*this.interactionExtends};if(o.isPointInBox({x:e,y:i},d))return this.interactionPart="caretFrameRight",this.model.interactionDownX=this.getXFromEvent(t)+this.model.shiftX*this.model.bottomChart.space/this.model.space,this.model.interactionDownY=this.getYFromEvent(t),this.model.interactionDownStartIndex=this.model.startIndex,this.model.interactionDownStartCount=this.model.count,this.model.pointX=null,void(this.model.pointY=null);var m={l:this.model.bottomChart.caret.frame.x-this.interactionExtends,t:this.model.bottomChart.caret.frame.y-this.interactionExtends,w:this.model.bottomChart.caret.frame.w+2*this.interactionExtends,h:this.model.bottomChart.caret.frame.h+2*this.interactionExtends};if(o.isPointInBox({x:e,y:i},m))return this.interactionPart="caretFrame",this.model.interactionDownX=this.getXFromEvent(t)+this.model.shiftX*this.model.bottomChart.space/this.model.space,this.model.interactionDownY=this.getYFromEvent(t),this.model.interactionDownStartIndex=this.model.startIndex,this.model.pointX=null,void(this.model.pointY=null);var c,p={l:this.model.bottomChart.caret.left.x-this.interactionExtends,t:this.model.bottomChart.caret.left.y-this.interactionExtends,w:this.model.bottomChart.caret.left.w+2*this.interactionExtends,h:this.model.bottomChart.caret.left.h+2*this.interactionExtends};if(o.isPointInBox({x:e,y:i},p))return this.interactionPart="caretLeft",this.model.interactionDownX=this.getXFromEvent(t)+this.model.shiftX*this.model.bottomChart.space/this.model.space,c=(this.model.interactionDownX-this.model.bottomChart.paddingLeft)/this.model.bottomChart.space,this.model.count=this.model.minCount,this.model.startIndex=Math.floor(c-this.model.count/2),this.correctPosition(),this.preventRenderTopFromCache(),this.model.pointX=null,void(this.model.pointY=null);var f={l:this.model.bottomChart.caret.right.x-this.interactionExtends,t:this.model.bottomChart.caret.right.y-this.interactionExtends,w:this.model.bottomChart.caret.right.w+2*this.interactionExtends,h:this.model.bottomChart.caret.right.h+2*this.interactionExtends};if(o.isPointInBox({x:e,y:i},f))return this.interactionPart="caretRight",this.model.interactionDownX=this.getXFromEvent(t)+this.model.shiftX*this.model.bottomChart.space/this.model.space,c=(this.model.interactionDownX-this.model.bottomChart.paddingLeft)/this.model.bottomChart.space,this.model.count=this.model.minCount,this.model.startIndex=Math.floor(c-this.model.count/2),this.correctPosition(),this.preventRenderTopFromCache(),this.model.pointX=null,void(this.model.pointY=null);for(var u in this.model.labels){var g=this.model.labels[u],v={l:g.x,t:g.y,w:g.w,h:g.h};if(o.isPointInBox({x:e,y:i},v))return void(this.interactionPart=g.id)}},s.prototype.onInteractionMove=function(t){requestAnimationFrame(function(){var e,i;this.model.interactionMoveX=this.getXFromEvent(t),this.model.interactionMoveY=this.getYFromEvent(t),"caretFrame"===this.interactionPart&&null!=this.model.interactionDownX&&null!=this.model.interactionDownY&&null!=this.model.interactionDownStartIndex&&(e=this.model.interactionMoveX-this.model.interactionDownX,i=e>=0?Math.floor(e/this.model.bottomChart.space):Math.ceil(e/this.model.bottomChart.space),this.model.startIndex=this.model.interactionDownStartIndex+i,this.model.shiftX=(-e+Math.floor(i*this.model.bottomChart.space))*this.model.space/this.model.bottomChart.space,this.correctPosition(),this.preventRenderTopFromCache()),"caretFrameLeft"===this.interactionPart&&null!=this.model.interactionDownX&&null!=this.model.interactionDownY&&null!=this.model.interactionDownStartIndex&&null!=this.model.interactionDownStartCount&&(e=this.model.interactionMoveX-this.model.interactionDownX,i=e>=0?Math.floor(e/this.model.bottomChart.space):Math.ceil(e/this.model.bottomChart.space),this.model.interactionDownStartIndex+i<0?(this.model.startIndex=0,this.model.shiftX=0):this.model.interactionDownStartCount-e/this.model.bottomChart.space>this.model.minCount&&(this.model.startIndex=this.model.interactionDownStartIndex+i,this.model.shiftX=(-e+i*this.model.bottomChart.space)*this.model.space/this.model.bottomChart.space,i=e/this.model.bottomChart.space,this.model.count=this.model.interactionDownStartCount-i),this.correctPosition(),this.preventRenderTopFromCache()),"caretFrameRight"===this.interactionPart&&null!=this.model.interactionDownX&&null!=this.model.interactionDownY&&null!=this.model.interactionDownStartIndex&&null!=this.model.interactionDownStartCount&&(e=this.model.interactionMoveX-this.model.interactionDownX,i=e/this.model.bottomChart.space,this.model.count=this.model.interactionDownStartCount+i,this.model.interactionDownStartIndex+this.model.count>=this.model.data.lines.x.length&&(this.model.count=this.model.data.lines.x.length-this.model.interactionDownStartIndex),this.correctPosition(),this.preventRenderTopFromCache()),this.refreshModel()}.bind(this))},s.prototype.correctPosition=function(){this.model.count<this.model.minCount&&(this.model.count=this.model.minCount);var t=this.model.data.lines.x.length-this.model.count;this.model.startIndex>t+1?(this.model.startIndex=Math.floor(t),this.model.count=Math.ceil(this.model.count),this.model.shiftX=0):this.model.startIndex<0&&(this.model.startIndex=0,this.model.count=Math.ceil(this.model.count),this.model.shiftX=0)},s.prototype.onInteractionUp=function(t){this.model.paddingRight=0,this.model.draggingMode=!1,o.toggleClass(this.view.canvas,"grabbing",!1),"touch"!=this.app.device?(this.model.interactionMoveX=this.getXFromEvent(t),this.model.interactionMoveY=this.getYFromEvent(t)):(this.model.interactionMoveX=this.getXFromEvent(t),this.model.interactionMoveY=this.getYFromEvent(t));var e=this.getXFromEvent(t),i=this.getYFromEvent(t);for(var n in this.model.labels){var a=this.model.labels[n],r={l:a.x,t:a.y,w:a.w,h:a.h};o.isPointInBox({x:e,y:i},r)&&this.interactionPart===a.id&&(this.model.data.actives[a.id]=!this.model.data.actives[a.id],this.preventRenderTopFromCache(),this.preventRenderBottomFromCache())}this.interactionPart=null,requestAnimationFrame(function(){this.refreshModel()}.bind(this))},s.prototype.preventRenderTopFromCache=function(){var t=this;this.preventTopTimeout&&clearTimeout(this.preventTopTimeout),this.preventTop=!0,this.preventTopTimeout=setTimeout(function(){t.preventTop=!1},this.animationDuration+100)},s.prototype.preventRenderBottomFromCache=function(){var t=this;this.preventBottomTimeout&&clearTimeout(this.preventBottomTimeout),this.preventBottom=!0,this.preventBottomTimeout=setTimeout(function(){t.preventBottom=!1},this.animationDuration+100)},s.prototype.refreshModel=function(t){if(!this.model.animatePoint){this.correctPosition();var e=this.model.data.lines.x.length,i=Math.min(this.model.count,e);this.model.max=-(1/0),this.model.min=1/0;var n,a,r,s;for(a=this.model.startIndex;a<this.model.startIndex+i;a++)for(r=0;r<this.model.data.keys.length;r++)n=this.model.data.keys[r],s=this.model.data.actives[n],s&&null!==this.model.data.lines[n][a]&&(this.model.data.lines[n][a]<this.model.min&&(this.model.min=this.model.data.lines[n][a]),this.model.data.lines[n][a]>this.model.max&&(this.model.max=this.model.data.lines[n][a]));this.model.max===-(1/0)&&(this.model.max=1),this.model.min===1/0&&(this.model.min=0),this.model.left=this.model.paddingLeft,this.model.top=this.model.paddingTop,this.model.width=this.view.canvas.width-this.model.paddingLeft-this.model.paddingRight,this.model.height=this.view.canvas.height-this.model.paddingTop-this.model.paddingBottom,this.model.space=this.model.width/(this.model.count-1),this.model.scale=(this.model.max-this.model.min)/this.model.height;var h=e-1,l=Math.ceil(70/this.model.space),d=Math.pow(2,Math.ceil(Math.log2(l))),m=this.model.axisXValues_divider;for(m&&this.model.axisXValues&&this.model.axisXValues.length&&(m<d?(this.prevState&&(this.prevState.axisXhideOpacity=1),this.model.axisXValues_hide=[].concat(this.model.axisXValues),this.model.axisXValues_opacity=0):m>d&&(this.prevState&&(this.prevState.axisXhideOpacity=0),this.model.axisXValues_hide=[].concat(this.model.axisXValues),this.model.axisXValues_opacity=1)),this.model.axisXValues_divider=d,this.model.axisXValues=[],a=e-1;a>0;a--)(h-a)%d===0&&(this.model.axisXValues.push(a),h=a);d=2;var c=this.model.max.toString().length;2===c?d=5:c>=3&&(d=Math.pow(10,c-2));var p=this.model.min,f=this.view.getYByValue(p,this.model);for(this.model.axisYValues=[p],p=Math.floor(p/d)*d,a=p;a<=2*this.model.max;a+=d)if(a%d===0){var u=this.view.getYByValue(a,this.model);f-u>=60&&(this.model.axisYValues.push(a),f=u)}for(this.model.crosshairX=null,this.model.crosshairY=null,this.model.hoveredIndex=null,null!=this.model.interactionMoveX&&null!=this.model.interactionMoveY&&(this.model.crosshairX=this.model.interactionMoveX,this.model.crosshairY=this.model.interactionMoveY,this.model.hoveredIndex=Math.round(this.model.crosshairX/this.model.space)),this.model.bottomChart.startIndex<0&&(this.model.bottomChart.startIndex=0),this.model.bottomChart.max=-(1/0),this.model.bottomChart.min=1/0,a=0;a<e;a++)for(r=0;r<this.model.data.keys.length;r++)n=this.model.data.keys[r],s=this.model.data.actives[n],s&&null!==this.model.data.lines[n][a]&&(this.model.data.lines[n][a]<this.model.bottomChart.min&&(this.model.bottomChart.min=this.model.data.lines[n][a]),this.model.data.lines[n][a]>this.model.bottomChart.max&&(this.model.bottomChart.max=this.model.data.lines[n][a]));this.model.bottomChart.max===-(1/0)&&(this.model.bottomChart.max=0),this.model.bottomChart.min===1/0&&(this.model.bottomChart.min=0),this.model.bottomChart.paddingTop=this.model.height+this.model.paddingTop+50,this.model.bottomChart.count=e,this.model.bottomChart.left=this.model.bottomChart.paddingLeft,this.model.bottomChart.width=this.view.canvas.width-this.model.bottomChart.paddingLeft-this.model.bottomChart.paddingRight,this.model.bottomChart.space=this.model.bottomChart.width/(e-1),this.model.bottomChart.scale=(this.model.bottomChart.max-this.model.bottomChart.min)/this.model.bottomChart.height,this.model.minCount=Math.floor(60/this.model.bottomChart.space);var g=this.model.bottomChart.space*this.model.shiftX/this.model.space,v=this.model.bottomChart.paddingLeft+this.model.startIndex*this.model.bottomChart.space-g,y=this.model.bottomChart.paddingTop-3,x=Math.floor(this.model.count*this.model.bottomChart.space),w=this.model.bottomChart.height+6;this.model.bottomChart.caret.left={x:this.model.bottomChart.paddingLeft,y:y,w:v-this.model.bottomChart.paddingLeft,h:w},this.model.bottomChart.caret.right={x:v+x,y:y,w:this.model.bottomChart.width-(v+x)+this.model.bottomChart.paddingLeft+2,h:w},this.model.bottomChart.caret.frame={left:{x:v,y:y,w:15,h:w},right:{x:v+x-15,y:y,w:15,h:w},top:{x:v+15,y:y,w:x-30,h:1},bottom:{x:v+15,y:y+w-1,w:x-30,h:1},x:v,y:y,w:x,h:w},this.model.labels=[];var b=this.model.bottomChart.caret.left.x;y=this.model.bottomChart.caret.left.y+this.model.bottomChart.caret.left.h+24,w=46;for(a in this.model.data.keys){var C=this.model.data.keys[a],T=this.model.data.names[C];x=o.calculateWidth(T,{fontFamily:"Helvetica, sans-serif",
fontSize:22,paddingLeft:50,paddingRight:10}),v=b+a*(x+9);var S={id:C,name:T,x:v,y:y,w:x,h:w,active:this.model.data.actives[C]};this.model.labels.push(S)}this.isModelRefreshed=!0;var D={startIndex:this.model.startIndex,shiftX:this.model.shiftX,count:this.model.count,scale:this.model.scale,min:this.model.min,max:this.model.max,bottom_scale:this.model.bottomChart.scale,bottom_min:this.model.bottomChart.min,bottom_max:this.model.bottomChart.max,axisXhideOpacity:this.model.axisXValues_opacity};this.prevState&&!t?(this.model.topChanged=this.topHasDiff(this.prevState,D),this.model.bottomChanged=this.bottomHasDiff(this.prevState,D)):(this.model.topChanged=!0,this.model.bottomChanged=!0),this.prevState&&D&&this.hasDiff(this.prevState,D)?this.animateTransition(this.prevState,D):this.view.refresh(this.model),this.prevState=D}},s.prototype.hasDiff=function(t,e){return t.scale!==e.scale||(t.min!==e.min||(t.max!==e.max||(t.bottom_scale!==e.bottom_scale||(t.bottom_min!==e.bottom_min||(t.bottom_max!==e.bottom_max||t.axisXhideOpacity!==e.axisXhideOpacity)))))},s.prototype.topHasDiff=function(t,e){return!!this.preventTop||(t.scale!==e.scale||(t.min!==e.min||t.max!==e.max))},s.prototype.bottomHasDiff=function(t,e){return!!this.preventBottom||(t.bottom_scale!==e.bottom_scale||(t.bottom_min!==e.bottom_min||t.bottom_max!==e.bottom_max))},s.prototype.animateTransition=function(t,e){var i=this,o=performance.now(),n=this.animationDuration;this.raf&&(n=this.animationDuration/1,cancelAnimationFrame(this.raf),this.raf=null),this.rafInRaf&&(n=this.animationDuration/2,cancelAnimationFrame(this.rafInRaf),this.rafInRaf=null),this.raf=requestAnimationFrame(function a(r){var s=(r-o)/n;s>1&&(s=1),i.view.render(i.transition(t,e,s)),s<1?i.rafInRaf=requestAnimationFrame(a):(i.view.render(i.transition(t,e,2)),i.raf=null,i.rafInRaf=null)})},s.prototype.transition=function(t,e,i){return t.animatePointFrom&&e.animatePointTo&&t.animatePointFrom.x!=e.animatePointTo.x?(2===i?this.model.animatePoint=null:this.model.animatePoint.x=t.animatePointFrom.x+(e.animatePointTo.x-t.animatePointFrom.x)*i,this.model):(t.scale!==e.scale&&2!==i&&(this.model.scale=t.scale+(e.scale-t.scale)*i),t.min!==e.min&&2!==i&&(this.model.min=t.min+(e.min-t.min)*i),t.max!==e.max&&2!==i&&(this.model.max=t.max+(e.max-t.max)*i),t.bottom_scale!==e.bottom_scale&&2!==i&&(this.model.bottomChart.scale=t.bottom_scale+(e.bottom_scale-t.bottom_scale)*i),t.bottom_min!==e.bottom_min&&2!==i&&(this.model.bottomChart.min=t.bottom_min+(e.bottom_min-t.bottom_min)*i),t.bottom_max!==e.bottom_max&&2!==i&&(this.model.bottomChart.max=t.bottom_max+(e.bottom_max-t.bottom_max)*i),t.axisXhideOpacity!==e.axisXhideOpacity&&(2===i?this.model.axisXValues_hide=null:this.model.axisXhideOpacity=t.axisXhideOpacity+(e.axisXhideOpacity-t.axisXhideOpacity)*i),this.model)},s.prototype.getModel=function(){return this.model},e.Chart=s},function(t,e,i){var o=i(3),n=i(4).EventDriven,a=function(t){this.app=t.app,this.view=t.view,this.active=!1};o.extend(a,n),a.prototype.activate=function(){this.view&&(this.active=!0,this.bindViewEvents())},a.prototype.deActivate=function(){this.view&&(this.active=!1,this.unBindViewEvents())},a.prototype.bindViewEvents=function(){this.view&&("mouse"===this.app.device?(o.on(this.view.$container,"mousedown",this.onEventDown.bind(this)),o.on(this.view.$container,"mousemove",this.onEventMove.bind(this)),o.on(this.view.$container,"mouseup",this.onEventUp.bind(this)),o.on(this.view.$container,"mouseout",this.onEventUp.bind(this)),o.on(this.view.$container,"mouseleave",this.onEventUp.bind(this))):"touch"===this.app.device&&(o.on(this.view.$container,"touchstart",this.onEventDown.bind(this)),o.on(this.view.$container,"touchmove",this.onEventMove.bind(this)),o.on(this.view.$container,"touchend",this.onEventUp.bind(this))))},a.prototype.unBindViewEvents=function(){this.view&&("mouse"===this.app.device?(o.off(this.view.$container,"mousedown"),o.off(this.view.$container,"mousemove"),o.off(this.view.$container,"mouseup"),o.off(this.view.$container,"mouseout"),o.off(this.view.$container,"mouseleave"),o.off(this.view.$container,"mousewheel")):"touch"===this.app.device&&(o.off(this.view.$container,"touchstart"),o.off(this.view.$container,"touchmove"),o.off(this.view.$container,"touchend")))},a.prototype.onEventDown=function(t){this.trigger("down",t)},a.prototype.onEventMove=function(t){this.trigger("move",t)},a.prototype.onEventUp=function(t){this.trigger("up",t)},e.Interaction=a},function(t,e,i){var o=i(3),n=i(8).UI,a=function(t){a.superclass.constructor.call(this,t),this.app=t.app,this.canvas=null,this.ctx=null,this.left=0,this.top=0,this.ready=!1,this.createView()};o.inherit(a,n),a.prototype.createView=function(){this.canvas=o.createElement({tag:"canvas",target:this.$container}),this.labels=o.createElement({tag:"div",class_name:"lines-labels",target:this.$container}),this.ctx=this.canvas.getContext("2d"),this.ctx.lineCap="round",this.ctx.lineJoin="round",this.canvas_top=o.createElement({tag:"canvas"}),this.canvas_bottom=o.createElement({tag:"canvas"}),this.ctx_top=this.canvas_top.getContext("2d"),this.ctx_bottom=this.canvas_bottom.getContext("2d");var t=setInterval(function(){this.$container.offsetWidth&&this.$container.offsetHeight&&(clearInterval(t),this.resize(),this.ready=!0,this.trigger("ready"))}.bind(this),10)},a.prototype.resize=function(){var t=o.box(this.$container);this.left=t.left,this.top=t.top,this.canvas.width=t.width,this.canvas.height=t.height,this.canvas_top.width=t.width,this.canvas_top.height=t.height,this.canvas_bottom.width=t.width,this.canvas_bottom.height=t.height},a.prototype.refresh=function(t){this.ready&&window.requestAnimationFrame(function(){this.render(t)}.bind(this))},a.prototype.getYByValue=function(t,e){return e.paddingTop+(e.max-t)/e.scale},a.prototype.getYByIndex=function(t,e,i){return this.getYByValue(i[t],e)},a.prototype.getCrossYByX=function(t,e,i){var n=0,a=this.getLeftIndexByX(t,e),r=this.getXByIndex(a,e),s=this.getYByIndex(a,e,i),h=a+1,l=this.getXByIndex(h,e),d=this.getYByIndex(h,e,i),m=o.getCrossLinePoint({x1:r,y1:s,x2:l,y2:d},{x1:t,y1:0,x2:t,y2:1e3});return m&&(n=m.y),n},a.prototype.getXByIndex=function(t,e){return e.paddingLeft+e.shiftX+(t-e.startIndex)*e.space},a.prototype.getLeftIndexByX=function(t,e){return e.startIndex+Math.floor((t-e.shiftX-e.paddingLeft)/e.space)},a.prototype.getNearestPointByX=function(t,e){var i=0,o=0,n=this.getLeftIndexByX(t,e),a=n+1,r=this.getXByIndex(n,e),s=this.getXByIndex(a,e),h=Math.abs(t-r),l=Math.abs(t-s);return i=n,o=r,l<h&&(i=a,o=s),{x:o,index:i,d0:h,d1:l}},a.prototype.render=function(t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawAxisY(this.ctx,t),this.drawAxisX(this.ctx,t),this.drawTitle(this.ctx,t),this.drawTopChart(this.ctx_top,t),"touch"!=this.app.device&&this.drawCrosshair(this.ctx,t),this.drawPoint(this.ctx,t),this.drawBottomChart(this.ctx_bottom,t),this.drawLabels(this.ctx,t)},a.prototype.drawTopChart=function(t,e){if(e.topChanged){t.clearRect(0,0,this.canvas_top.width,this.canvas_top.height);var i,o,n,a;for(i in e.data.keys)o=e.data.keys[i],n=e.data.lines[o],a=e.data.actives[o],a&&(t.beginPath(),t.lineCap="round",t.lineJoin="round",t.lineWidth=e.lineWidth,t.strokeStyle=e.data.colors[o],this.drawTopLine(t,e,n))}this.ctx.drawImage(this.canvas_top,0,0,this.canvas_top.width,this.canvas_top.height)},a.prototype.drawBottomChart=function(t,e){if(e.bottomChanged){t.clearRect(0,0,this.canvas_bottom.width,this.canvas_bottom.height);var i,o,n,a;for(i in e.data.keys)o=e.data.keys[i],n=e.data.lines[o],a=e.data.actives[o],a&&(t.beginPath(),t.lineCap="round",t.lineJoin="round",t.lineWidth=e.bottomChart.lineWidth,t.strokeStyle=e.data.colors[o],this.drawBottomLine(t,e,n))}this.ctx.drawImage(this.canvas_bottom,0,0,this.canvas_bottom.width,this.canvas_bottom.height),this.drawBottomCaret(this.ctx,e)},a.prototype.drawAxisY=function(t,e){var i,n=e.paddingLeft,a=e.paddingLeft+e.width;t.beginPath(),t.lineWidth=1,t.textAlign="left",t.font="normal 16px Helvetica, sans-serif",t.strokeStyle=e.style[e.renderStyle].gridColor,t.fillStyle=e.style[e.renderStyle].gridValuesColor;for(var r in e.axisYValues){var s=e.axisYValues[r];if(i=this.getYByValue(s,e),i<e.top)break;t.moveTo(n+e.gridSpace,i),t.lineTo(a-e.gridSpace,i),t.fillText(o.collapseNumber(s),n+e.gridSpace,i-6)}t.stroke()},a.prototype.drawAxisX=function(t,e){var i=e.startIndex;i<0&&(i=0);var n,a,r=i+e.count+1,s=e.paddingTop+e.height;a=e.data.lines.x,t.beginPath(),t.textAlign="center",t.font="normal 16px Helvetica, sans-serif",t.fillStyle=e.style[e.renderStyle].timeColor;for(var h,l=i;l<r;l++)a[l]&&(n=Math.floor((l-i)*e.space)+e.shiftX,h=o.formatDate("d Mon",a[l]),e.axisXValues.indexOf(l)!==-1&&t.fillText(h,n,s+20));t.beginPath(),t.strokeStyle=e.style[e.renderStyle].axisColor,t.lineWidth=1,t.moveTo(e.paddingLeft+e.gridSpace,e.paddingTop+e.height),t.lineTo(e.paddingLeft+e.width-e.gridSpace,e.paddingTop+e.height),t.stroke(),t.closePath()},a.prototype.drawTitle=function(t,e){var i=e.data.lines.x;t.save(),t.beginPath(),t.textBaseline="bottom",t.textAlign="left",t.font="bold 22px Helvetica, sans-serif",t.fillStyle=e.style[e.renderStyle].title,t.fillText(e.title,e.gridSpace,e.paddingTop-30);var n=o.formatDate("d Month YEAR",i[this.getNearestPointByX(e.paddingLeft+e.gridSpace,e).index]),a=o.formatDate("d Month YEAR",i[this.getNearestPointByX(e.width-e.gridSpace,e).index]),r=n+" - "+a;t.font="bold 18px Helvetica, sans-serif",t.textAlign="right",t.fillText(r,e.paddingLeft+e.width-e.gridSpace,e.paddingTop-30),t.restore()},a.prototype.drawCrosshair=function(t,e){if(null==e.crosshairX||null==e.crosshairY)return void(e.crosshair=null);var i=e.paddingTop,n=e.paddingTop+e.height,a=e.crosshairX,r=e.crosshairY,s=this.getNearestPointByX(a,e),h=s.index,l=s.x;if(e.data.lines.x[h]&&r>=i&&r<=n){t.dashedLinePattern(a,i-18,a,n,[4,4],e.style[e.renderStyle].crosshairColor,1),t.fillStyle=e.style[e.renderStyle].crosshairColor;var d=o.formatDate("d Month YEAR",e.data.lines.x[h]);t.textAlign="center",l<e.width/2-e.width/4?(t.textAlign="left",l-=5):l>e.width/2+e.width/4&&(t.textAlign="right",l+=5),t.font="normal 12px Helvetica, sans-serif",t.fillText(d,a,i-23),e.crosshair={xx:l,index:h}}},a.prototype.drawTopLine=function(t,e,i){var o,n,a,r=e.startIndex+e.count+1;r>i.length&&(r=i.length);var s=e.paddingLeft+e.shiftX-(e.startIndex>=0?e.space:0),h=this.getYByValue(i[e.startIndex>0?e.startIndex-1:0],e);for(t.moveTo(s,h),o=e.startIndex;o<r;o++)null!==i[o]&&(n=s+e.space,a=this.getYByValue(i[o],e),t.lineTo(n,a),s=n,h=a);t.stroke()},a.prototype.drawBottomLine=function(t,e,i){var o,n,a,r=e.bottomChart.count;r>i.length-1&&(r=i.length-1);var s=e.bottomChart.paddingLeft,h=this.getYByValue(i[0],e.bottomChart);for(t.moveTo(s,h),o=0;o<r;o++)null!==i[o]&&(n=s+e.bottomChart.space,a=this.getYByValue(i[o],e.bottomChart),t.lineTo(n,a),s=n,h=a);t.stroke()},a.prototype.drawBottomCaret=function(t,e){t.beginPath(),t.fillStyle=e.style[e.renderStyle].bottomColor,t.strokeStyle=e.style[e.renderStyle].bottomColor,t.roundRect(e.bottomChart.caret.left.x,e.bottomChart.caret.left.y,e.bottomChart.caret.left.w+10,e.bottomChart.caret.left.h,{upperLeft:10,upperRight:0,lowerLeft:10,lowerRight:0},!0,!0),e.bottomChart.width-e.bottomChart.caret.right.x+e.bottomChart.paddingLeft>0&&(t.beginPath(),t.fillStyle=e.style[e.renderStyle].bottomColor,t.strokeStyle=e.style[e.renderStyle].bottomColor,t.roundRect(e.bottomChart.caret.right.x-10,e.bottomChart.caret.right.y,e.bottomChart.caret.right.w+10,e.bottomChart.caret.right.h,{upperLeft:0,upperRight:10,lowerLeft:0,lowerRight:10},!0,!0)),t.beginPath(),t.fillStyle=e.style[e.renderStyle].caretColor,t.strokeStyle=e.style[e.renderStyle].caretColor,t.roundRect(e.bottomChart.caret.frame.left.x,e.bottomChart.caret.frame.left.y,e.bottomChart.caret.frame.left.w,e.bottomChart.caret.frame.left.h-1,{upperLeft:10,upperRight:0,lowerLeft:10,lowerRight:0},!0,!0),t.fillStyle=e.style[e.renderStyle].caretHoleColor,t.strokeStyle=e.style[e.renderStyle].caretHoleColor,t.roundRect(e.bottomChart.caret.frame.left.x+6,e.bottomChart.caret.frame.left.y+22,2,16,1,!0,!0),t.fillStyle=e.style[e.renderStyle].caretColor,t.strokeStyle=e.style[e.renderStyle].caretColor,t.roundRect(e.bottomChart.caret.frame.right.x,e.bottomChart.caret.frame.right.y,e.bottomChart.caret.frame.right.w,e.bottomChart.caret.frame.right.h-1,{upperLeft:0,upperRight:10,lowerLeft:0,lowerRight:10},!0,!0),t.fillStyle=e.style[e.renderStyle].caretHoleColor,t.strokeStyle=e.style[e.renderStyle].caretHoleColor,t.roundRect(e.bottomChart.caret.frame.right.x+6,e.bottomChart.caret.frame.right.y+22,2,16,1,!0,!0),t.fillStyle=e.style[e.renderStyle].caretColor,t.strokeStyle=e.style[e.renderStyle].caretColor,t.fillRect(e.bottomChart.caret.frame.top.x,e.bottomChart.caret.frame.top.y,e.bottomChart.caret.frame.top.w,e.bottomChart.caret.frame.top.h),t.fillRect(e.bottomChart.caret.frame.bottom.x,e.bottomChart.caret.frame.bottom.y,e.bottomChart.caret.frame.bottom.w,e.bottomChart.caret.frame.bottom.h),t.closePath()},a.prototype.drawLabels=function(t,e){t.save();var i,o,n,a,r,s,h;for(i in e.labels)s=e.labels[i],h=s.name,o=s.x,n=s.y,a=s.w,r=s.h,s.active?(t.beginPath(),t.lineWidth=2,t.fillStyle=e.data.colors[s.id],t.strokeStyle=e.data.colors[s.id],t.roundRect(o,n,a,r,25,!0,!0),t.drawImage(e.checkerImg,o+6,n+6,35,35),t.beginPath(),t.textBaseline="middle",t.textAlign="left",t.font="normal 22px Helvetica, sans-serif",t.fillStyle=e.style[e.renderStyle].labelText,t.fillText(h,o+44,n+26)):(t.beginPath(),t.lineWidth=2,t.strokeStyle=e.data.colors[s.id],t.roundRect(o,n,a,r,25,!1,!0),t.beginPath(),t.textBaseline="middle",t.font="normal 22px Helvetica, sans-serif",t.textAlign="center",t.fillStyle=e.data.colors[s.id],t.fillText(h,o+a/2,n+26));t.restore()},a.prototype.drawPoint=function(t,e){if(null==e.pointX||null==e.pointY)return void(e.point=null);var i=e.pointX,n=e.pointY;e.animatePoint&&(i=e.animatePoint.x,e.pointX=i);var a=e.paddingTop,r=e.paddingTop+e.height,s=this.getNearestPointByX(i,e),h=s.index,l=s.x;if(e.data.lines.x[h]){var d,m,c=0;if(e.animatePoint&&(c=s.d0/(s.d0+s.d1)),t.beginPath(),t.strokeStyle=e.style[e.renderStyle].crosshairColor,t.fillStyle=e.style[e.renderStyle].crosshairColor,t.lineWidth=1,n>=a&&n<=r){e.animatePoint?(t.moveTo(i,a),t.lineTo(i,r)):(t.moveTo(l,a),t.lineTo(l,r)),t.stroke();var p=[];t.save();var f,u,g,v,y,x,w;for(f in e.data.keys)u=e.data.keys[f],g=e.data.lines[u],v=e.style[e.renderStyle].bgColor,y=e.data.colors[u],x=e.data.actives[u],x&&(p.push({id:e.data.names[u],value:g[h],color:e.data.colors[u]}),w=e.animatePoint?this.getCrossYByX(i,e,g):this.getYByValue(g[h],e),t.beginPath(),t.lineWidth=e.lineWidth,t.fillStyle=v,t.strokeStyle=y,e.animatePoint?t.arc(i,w,6,0,2*Math.PI):t.arc(l,w,6,0,2*Math.PI),t.fill(),t.stroke());var b=288,C=0;p.length&&p.reduce(function(t,e){e.value>C&&(C=e.value)});var T=o.formatDate("Wee, d Mon YEAR",e.data.lines.x[h]),S=e.point&&e.point.prevTitle?e.point.prevTitle:T;C>0&&(minWidth=o.calculateWidth(C.toString(),{fontFamily:"Helvetica, sans-serif",fontSize:18,paddingLeft:20,paddingRight:20}));var D=p.length,X=Math.max(58,50+32*D);t.fillStyle=e.style[e.renderStyle].tooltipBg,t.strokeStyle=e.style[e.renderStyle].tooltipBg,t.shadowColor=e.style[e.renderStyle].tooltipShadow,t.shadowBlur=3;var E=l-b/2;e.animatePoint&&(E=i-b/2);var I=a-20;E<3&&(E=3),E+b>e.width-3&&(E=e.width-3-b),t.roundRect(E,I,b,X,14,!0,!1);var R,M=18;t.beginPath(),t.shadowBlur=0,t.fillStyle=e.style[e.renderStyle].tooltipTitle,t.textAlign="left",t.textBaseline="top",t.save(),t.globalAlpha=1-c,R=M-M*c,t.font="bold "+R+"px Helvetica, sans-serif",t.fillText(T,E+20,I+20-5*c),t.restore(),t.save(),t.globalAlpha=c,R=M*c,t.font="bold "+R+"px Helvetica, sans-serif",t.fillText(S,E+20,I+20+M-R),t.restore(),p.length&&t.drawImage(e.arrowImg,E+b-30,I+20,10,20),n=I+20+32;for(f in p)g=p[f],name=g.id,y=g.color,d=o.formatTo3(g.value),m=e.point&&e.point.prevVisibleLines[f]?e.point.prevVisibleLines[f]._value:d,t.fillStyle=e.style[e.renderStyle].tooltipTitle,t.textAlign="left",t.font="normal "+M+"px Helvetica, sans-serif",t.fillText(name,E+20,n+32*f),t.textAlign="right",t.font="bold "+M+"px Helvetica, sans-serif",t.fillStyle=y,t.save(),t.globalAlpha=1-c,R=M-M*c,t.font="bold "+R+"px Helvetica, sans-serif",t.fillText(d,E+b-20,n+32*f-5*c),t.restore(),t.save(),t.globalAlpha=c,R=M*c,t.font="bold "+R+"px Helvetica, sans-serif",t.fillText(m,E+b-20,n+32*f+M-R),t.restore(),p[f]._value=d,p[f]._valueX=E+b-20,p[f]._valueY=n+32*f;t.restore(),e.point={x:E,y:I,w:b,h:X,xx:e.animatePoint?i:l,index:h,prevVisibleLines:p,canZoom:p.length>0,prevTitle:T,titleX:E+20,titleY:I+20}}}},e.ChartView=a},function(t,e,i){var o=i(3),n=i(4).EventDriven,a=function(t){t=t||{};var e=t.className;t.extraClassName&&(e+=" "+t.extraClassName);var i=null;t.noDisplayOnCreate===!0&&(i=[{display:"none"}]),this.$container=null==t.container?o.createElement({class_name:e,attributes:i}):o.getElement(t.container),this.parent=t.parent,this.appendTo(t.appendTo||this.parent)};o.extend(a,n),a.prototype.appendTo=function(t){t&&(t instanceof Element?t.appendChild(this.$container):t instanceof a?t.$container.append?t.$container.append(this.$container):t.$container.appendChild(this.$container):console.trace("ERROR: UI want to append to unsupported parent",t))},a.prototype.show=function(){return this.hidden?(this.hidden=!1,o.show(this.$container),this):this},a.prototype.hide=function(){return this.hidden?this:(this.hidden=!0,o.hide(this.$container),this)},a.prototype.destroy=function(){this.$container&&(o.removeElement(this.$container),this.$container=null)},e.UI=a},function(t,e,i){var o=i(3),n=i(8).UI,a=function(t){a.superclass.constructor.call(this,t),this.app=t.app,this.createView()};o.inherit(a,n),a.prototype.createView=function(){this.chartsContainer=o.createElement({tag:"div",class_name:"charts-container",target:this.$container}),this.notes1=o.createElement({tag:"div",class_name:"notes",html:"Note: please reload page after you change device emulation mode to Mobile or after back to Desktop (for apply relevant pointer events)",target:this.$container}),this.notes2=o.createElement({tag:"div",class_name:"notes",html:"PS: All implemented sizes are 50% from original designs (contest style guides).",target:this.$container}),this.switchThemeToDay=o.createElement({tag:"div",class_name:"switch-theme to-day",html:"Switch to Day Mode",target:this.$container}),this.switchThemeToNight=o.createElement({tag:"div",class_name:"switch-theme to-night",html:"Switch to Night Mode",target:this.$container})},e.MainView=a}]);